# MapQC 3D
![Threejs](https://img.shields.io/badge/threejs-black?style=for-the-badge&logo=three.js&logoColor=white)
![Vite](https://img.shields.io/badge/vite-%23646CFF.svg?style=for-the-badge&logo=vite&logoColor=white)
![NodeJS](https://img.shields.io/badge/node.js-6DA55F?style=for-the-badge&logo=node.js&logoColor=white)
![Visual Studio Code](https://img.shields.io/badge/Visual%20Studio%20Code-0078d7.svg?style=for-the-badge&logo=visual-studio-code&logoColor=white)
![TypeScript](https://img.shields.io/badge/typescript-%23007ACC.svg?style=for-the-badge&logo=typescript&logoColor=white)
![GitHub Copilot](https://img.shields.io/badge/github_copilot-8957E5?style=for-the-badge&logo=github-copilot&logoColor=white)


MapQC 3D is a structured monorepo designed for:

• GeoTIFF QA validation  
• True-coordinate 3D inspection (three.js)  
• JSON + PDF reporting  
• Batch automation via Node CLI  
• AI-assisted development via ai-dev agents + Copilot instructions  

This repository is intentionally structured for scalability, testability, and deterministic outputs.

---

# Architecture Overview

The system is divided into three logical layers:

1. apps/web  
   - Vite + React + TypeScript  
   - three.js viewport  
   - GeoTIFF ingestion (browser-safe)  
   - UI-based QA review  

2. apps/cli  
   - Node.js + TypeScript  
   - RunContext orchestration  
   - Continue-on-error batch processing  
   - JSON + PDF report output  

3. packages/shared  
   - Domain models  
   - QA validation logic  
   - Report schema  
   - Shared types  

Shared code contains **zero runtime-specific dependencies**.

---

# Design Principles

• No global mutable state  
• Explicit RunContext lifecycle  
• Deterministic outputs  
• Strict TypeScript  
• Pure QA functions  
• three.js disposal discipline  
• Continue-on-error orchestration in CLI  
• Structured logging (JSON-first)  

---

# Development Workflow

## Install

```bash
npm install
```

## Run Web UI

```bash
npm run dev:web
```

## Run CLI

```bash
npm run dev:cli -- scan --input ./data --out ./reports --sidecars warn
```

---

# Directory Structure

```
mapqc-3d/
  .github/
  ai-dev/
  apps/
    web/
    cli/
  packages/
    shared/
  logs/
  run_history.json
```

---

# Implementation Roadmap

Phase 1  
• Implement GeoTIFF reader (shared interface)  
• Derive extent + pixel size  
• Wire QA checks  
• Display metadata in UI  

Phase 2  
• Render raster plane in map units  
• Add camera fit-to-extent  
• Implement texture disposal discipline  

Phase 3  
• JSON export  
• PDF export via pdf-lib  
• CLI batch scanning  

Phase 4  
• CRS awareness  
• Optional reprojection  
• Performance profiling  

---

# AI Development Strategy

All agent definitions are inside /ai-dev.

Use them as structured prompts for:
• Copilot Agents  
• Codex  
• Claude  
• Other LLM-based tooling  

Keep rules in ai-dev; keep loader thin.

---

# Production Notes

This stub is intentionally strict.  
Do not loosen TypeScript.  
Do not move domain logic into UI.  
Do not bypass RunContext in CLI.

---
